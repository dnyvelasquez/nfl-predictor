<div class="asignacion-container">
    <mat-card class="asignacion-card">
        <div class="header">
            <img src="https://static.www.nfl.com/image/upload/v1554321393/league/nvfr7ogywskqrfaiu38m.svg" alt="NFL Logo" class="logo">
            <mat-card-title class="asignacion-title">Asignaci√≥n de Equipos</mat-card-title>
            <h1> üèà</h1>
            <mat-divider></mat-divider>
        </div>

        <div class="button-container">
        <button class="left" mat-menu-item routerLink="/admin">
            <mat-icon>arrow_back</mat-icon>
            <span>Volver</span>
        </button>
        <button mat-stroked-button class="reset" (click)="resetAll()">
            <mat-icon>restart_alt</mat-icon>&nbsp;Reset
        </button>
        <button class="right" mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span>Logout</span>
        </button>
        </div>

        @if (errorMsg()) { <div class="err">{{ errorMsg() }}</div> }
        @if (okMsg())    { <div class="ok">{{ okMsg() }}</div> }

        <div class="matrix-wrapper" [class.loading]="loading()">

            <div class="grid" 
                [style.gridTemplateColumns]="'100px ' + '1fr '.repeat(participantes().length)">
            <div class="cell head sticky">&nbsp;</div>
            @for (p of participantes(); track p.id) {
                <div class="cell head sticky">{{ p.numero }} - {{ p.nombre }}</div>
            }

            @for (d of divisiones(); track d) {
                <div class="cell head sticky-left">{{ d }}</div>

                @for (p of participantes(); track p.id) {
                <div class="cell">
                    <mat-select
                        [value]="valorCelda(d, p.nombre)"
                        (selectionChange)="onChangeCelda(d, p.nombre, $event.value)"
                        disableOptionCentering
                        panelClass="asig-panel"
                    >
                    <mat-option [value]="null">‚Äî Sin asignaci√≥n ‚Äî</mat-option>
                    @for (eq of opcionesPara(d, p.nombre); track eq.id) {
                        <mat-option [value]="eq.id">{{ eq.nombre }}</mat-option>
                    }
                    </mat-select>
                </div>
                }
            }
            </div>
        </div>

    </mat-card>
</div>